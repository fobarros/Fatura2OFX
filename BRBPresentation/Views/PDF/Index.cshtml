@using (Html.BeginForm("Upload", "Pdf", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    <div class="form-group">
        <label for="file">Escolha um arquivo PDF:</label>
        <input type="file" name="file" class="form-control" required />
    </div>

    <div class="form-group mt-3">
        <label for="tipoSaida">Formato de Saída:</label>
        <select name="tipoSaida" id="tipoSaida" class="form-control" required>
            @foreach (var tipo in ViewBag.TiposSaida)
            {
                <option value="@tipo">@tipo</option>
            }
        </select>
    </div>

    <div class="form-group mt-3" id="debugContainer">
        <div class="form-check">
            <input type="checkbox" class="form-check-input" id="debugMode" name="debugMode" value="true">
            <label class="form-check-label" for="debugMode">Modo Debug</label>
        </div>
    </div>

    <div class="mt-3">
        <input type="submit" value="Upload" class="btn btn-primary" />
    </div>
}

<script>
    function atualizarVisibilidadeDebug() {
        var tipoSaida = document.getElementById('tipoSaida');
        var debugContainer = document.getElementById('debugContainer');
        var isTela = tipoSaida.value === 'Tela';
        
        // Salva a seleção atual no localStorage
        localStorage.setItem('tipoSaidaSelecionado', tipoSaida.value);
        
        debugContainer.style.display = isTela ? 'block' : 'none';
    }

    // Restaura a seleção anterior do combo
    function restaurarSelecao() {
        var tipoSaida = document.getElementById('tipoSaida');
        var tipoSelecionado = localStorage.getItem('tipoSaidaSelecionado');
        
        if (tipoSelecionado) {
            tipoSaida.value = tipoSelecionado;
        }
        
        atualizarVisibilidadeDebug();
    }

    // Atualizar quando o combo mudar
    document.getElementById('tipoSaida').addEventListener('change', atualizarVisibilidadeDebug);

    // Restaurar estado quando a página carregar
    window.addEventListener('load', restaurarSelecao);
    
    // Restaurar estado quando voltar no navegador
    window.addEventListener('pageshow', function(event) {
        restaurarSelecao();
    });

    // Executar imediatamente para garantir o estado inicial
    restaurarSelecao();
</script>
